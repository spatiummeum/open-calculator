7858da7834506cd33ab9b663ce4cbd1b
"use strict";

// =========================
// VARIABLES Y ELEMENTOS DEL DOM
// =========================
// Array para almacenar los productos a descontar
// Cada producto es un objeto: { value: número, isHalf: booleano }
let productsToDiscount = [];

// Helper function to safely get DOM elements
const safeGetElement = id => {
  if (typeof document !== 'undefined' && document.getElementById) {
    return document.getElementById(id);
  }
  return null;
};
const invoiceTotalInput = safeGetElement('invoice-total');
const productValueInput = safeGetElement('product-value');
const isHalfCheckbox = safeGetElement('is-half');
const addProductBtn = safeGetElement('add-product-btn');
const calculateBtn = safeGetElement('calculate-btn');
const productsList = safeGetElement('products-list');
const resultsCard = safeGetElement('results-card');
const clearAllBtn = safeGetElement('clear-all-btn');

// =========================
// UTILIDAD: Formatear moneda CLP
// =========================
// Formatea un número como moneda chilena (pesos) con 2 decimales
// Ejemplo: 10000.50 -> "$10.000,50"
const formatCurrency = amount => {
  return new Intl.NumberFormat('es-CL', {
    style: 'currency',
    currency: 'CLP',
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  }).format(amount);
};

// =========================
// MANEJO DE ERRORES
// =========================
// Referencias a elementos DOM para mostrar mensajes de error
const errorAlertElement = safeGetElement('error-alert');
const errorMessageElement = safeGetElement('error-message');

// Muestra un mensaje de error en la interfaz
// @param {string} message - Mensaje de error a mostrar
const showError = message => {
  if (errorMessageElement) {
    errorMessageElement.textContent = message;
  }
  if (errorAlertElement) {
    errorAlertElement.style.display = 'block';
  }
};

// Oculta el mensaje de error
const hideError = () => {
  if (errorAlertElement) {
    errorAlertElement.style.display = 'none';
  }
};

// =========================
// RENDERIZAR LISTA DE PRODUCTOS
// =========================
// Actualiza la interfaz mostrando la lista de productos agregados
// Si no hay productos, muestra un estado vacío
function renderProductsList() {
  // Return early if not in browser environment
  if (!productsList || typeof document === 'undefined') {
    return;
  }

  // Limpiar lista de manera segura
  while (productsList.firstChild) {
    productsList.removeChild(productsList.firstChild);
  }
  if (productsToDiscount.length === 0) {
    const emptyState = document.createElement('p');
    emptyState.className = 'empty-state';
    emptyState.textContent = 'No hay productos agregados';
    productsList.appendChild(emptyState);
    if (calculateBtn) calculateBtn.style.display = 'none';
    if (clearAllBtn) clearAllBtn.style.display = 'none';
    return;
  }
  productsToDiscount.forEach((product, idx) => {
    const div = document.createElement('div');
    div.className = 'product-item';
    const productInfo = document.createElement('div');
    productInfo.className = 'product-info';
    const p = document.createElement('p');
    const strong = document.createElement('strong');
    // Usar valor float directamente
    const baseValue = product.isHalf ? product.value / 2 : product.value;
    strong.textContent = formatCurrency(baseValue);
    p.appendChild(document.createTextNode('Producto con valor base de '));
    p.appendChild(strong);
    const small = document.createElement('small');
    small.textContent = `Unidades: ${product.isHalf ? 'Sí' : 'No'}`;
    productInfo.appendChild(p);
    productInfo.appendChild(small);
    const button = document.createElement('button');
    button.className = 'btn btn-outline btn-small';
    button.dataset.idx = idx;
    button.title = 'Eliminar';

    // Crear ícono de eliminación de manera segura
    const icon = document.createElement('span');
    icon.textContent = '✕'; // Uso de entidad segura
    button.appendChild(icon);
    div.appendChild(productInfo);
    div.appendChild(button);
    productsList.appendChild(div);
  });

  // Mostrar botones cuando hay productos
  if (calculateBtn) calculateBtn.style.display = 'block';
  if (clearAllBtn) clearAllBtn.style.display = 'block';

  // Asignar eventos a los botones de eliminar
  if (productsList.querySelectorAll) {
    productsList.querySelectorAll('button[data-idx]').forEach(btn => {
      btn.addEventListener('click', e => {
        const idx = parseInt(btn.getAttribute('data-idx'));
        if (!isNaN(idx) && idx >= 0 && idx < productsToDiscount.length) {
          productsToDiscount.splice(idx, 1);
          renderProductsList();
          if (resultsCard) resultsCard.style.display = 'none';
        }
      });
    });
  }
}

// =========================
// EVENTO: Agregar producto
// =========================
// Maneja el clic en el botón "Agregar producto":
// 1. Valida que el valor ingresado sea válido (>0)
// 2. Agrega el producto al array productsToDiscount
// 3. Actualiza la lista de productos
// 4. Limpia los campos de entrada
if (addProductBtn) {
  addProductBtn.addEventListener('click', () => {
    const value = parseFloat(productValueInput?.value);
    const isHalf = isHalfCheckbox?.checked;

    // Validación mejorada - valores numéricos y límites
    if (isNaN(value) || value <= 0 || value > 1000000000) {
      showError('Por favor, ingrese un valor de producto válido entre 1 y 1.000.000.000.');
      return;
    }

    // Validar que el valor no contenga más de 2 decimales
    if ((value.toString().split('.')[1] || []).length > 2) {
      showError('Por favor, ingrese un valor con máximo 2 decimales.');
      return;
    }

    // Guardamos el producto en nuestro array
    productsToDiscount.push({
      value,
      isHalf
    });
    renderProductsList();
    // Limpiamos los inputs y ocultamos errores
    if (productValueInput) productValueInput.value = '';
    if (isHalfCheckbox) isHalfCheckbox.checked = false;
    if (productValueInput) productValueInput.focus();
    hideError();
  });
}

// =========================
// EVENTO: Limpiar todo
// =========================
// Resetea toda la aplicación:
// 1. Vacía la lista de productos
// 2. Limpia todos los campos de entrada
// 3. Oculta los resultados
if (clearAllBtn) {
  clearAllBtn.addEventListener('click', () => {
    productsToDiscount.length = 0;
    renderProductsList();
    if (resultsCard) resultsCard.style.display = 'none';
    if (productValueInput) productValueInput.value = '';
    if (isHalfCheckbox) isHalfCheckbox.checked = false;
    if (invoiceTotalInput) invoiceTotalInput.value = '';
  });
}

// =========================
// EVENTO: Calcular descuento final
// =========================
// Realiza el cálculo completo de descuentos:
// 1. Valida el monto total de la factura
// 2. Calcula el descuento para cada producto (considerando IVA)
// 3. Actualiza la interfaz con los resultados
if (calculateBtn) {
  calculateBtn.addEventListener('click', () => {
    const originalInvoiceTotal = parseFloat(invoiceTotalInput?.value);

    // Validación mejorada para el total de la factura
    if (isNaN(originalInvoiceTotal) || originalInvoiceTotal <= 0 || originalInvoiceTotal > 10000000000) {
      showError('Por favor, ingrese un monto de factura válido entre 1 y 10.000.000.000.');
      return;
    }

    // Validar decimales
    if ((originalInvoiceTotal.toString().split('.')[1] || []).length > 2) {
      showError('El monto de la factura debe tener máximo 2 decimales.');
      return;
    }
    if (productsToDiscount.length === 0) {
      showError('Por favor, añada al menos un producto para descontar.');
      return;
    }
    hideError();
    let totalDiscountAmount = 0;
    const IVA_RATE = 0.19; // Tasa de IVA (19%)

    // Cálculo de descuento manteniendo precisión float
    productsToDiscount.forEach(product => {
      // 1. Determinar valor base: completo o mitad (para unidades)
      let baseValueToDiscount = product.isHalf ? product.value / 2 : product.value;

      // 2. Calcular valor con IVA: base * (1 + IVA_RATE)
      let valueWithIva = baseValueToDiscount * (1 + IVA_RATE);

      // 3. Acumular al descuento total manteniendo float
      totalDiscountAmount += valueWithIva;
    });

    // 4. Calcular el nuevo total con float
    const newInvoiceTotal = originalInvoiceTotal - totalDiscountAmount;

    // Mostramos los resultados
    const resultOriginal = safeGetElement('result-original');
    const resultDiscount = safeGetElement('result-discount');
    const resultTotal = safeGetElement('result-total');
    if (resultOriginal) resultOriginal.textContent = formatCurrency(originalInvoiceTotal);
    if (resultDiscount) resultDiscount.textContent = formatCurrency(totalDiscountAmount);
    if (resultTotal) resultTotal.textContent = formatCurrency(newInvoiceTotal);
    if (resultsCard) resultsCard.style.display = 'block';
  });
}

// Export functions for testing
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    formatCurrency,
    showError,
    hideError,
    renderProductsList,
    productsToDiscount,
    safeGetElement
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwcm9kdWN0c1RvRGlzY291bnQiLCJzYWZlR2V0RWxlbWVudCIsImlkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImludm9pY2VUb3RhbElucHV0IiwicHJvZHVjdFZhbHVlSW5wdXQiLCJpc0hhbGZDaGVja2JveCIsImFkZFByb2R1Y3RCdG4iLCJjYWxjdWxhdGVCdG4iLCJwcm9kdWN0c0xpc3QiLCJyZXN1bHRzQ2FyZCIsImNsZWFyQWxsQnRuIiwiZm9ybWF0Q3VycmVuY3kiLCJhbW91bnQiLCJJbnRsIiwiTnVtYmVyRm9ybWF0Iiwic3R5bGUiLCJjdXJyZW5jeSIsIm1pbmltdW1GcmFjdGlvbkRpZ2l0cyIsIm1heGltdW1GcmFjdGlvbkRpZ2l0cyIsImZvcm1hdCIsImVycm9yQWxlcnRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInNob3dFcnJvciIsIm1lc3NhZ2UiLCJ0ZXh0Q29udGVudCIsImRpc3BsYXkiLCJoaWRlRXJyb3IiLCJyZW5kZXJQcm9kdWN0c0xpc3QiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJsZW5ndGgiLCJlbXB0eVN0YXRlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwiZm9yRWFjaCIsInByb2R1Y3QiLCJpZHgiLCJkaXYiLCJwcm9kdWN0SW5mbyIsInAiLCJzdHJvbmciLCJiYXNlVmFsdWUiLCJpc0hhbGYiLCJ2YWx1ZSIsImNyZWF0ZVRleHROb2RlIiwic21hbGwiLCJidXR0b24iLCJkYXRhc2V0IiwidGl0bGUiLCJpY29uIiwicXVlcnlTZWxlY3RvckFsbCIsImJ0biIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicGFyc2VJbnQiLCJnZXRBdHRyaWJ1dGUiLCJpc05hTiIsInNwbGljZSIsInBhcnNlRmxvYXQiLCJjaGVja2VkIiwidG9TdHJpbmciLCJzcGxpdCIsInB1c2giLCJmb2N1cyIsIm9yaWdpbmFsSW52b2ljZVRvdGFsIiwidG90YWxEaXNjb3VudEFtb3VudCIsIklWQV9SQVRFIiwiYmFzZVZhbHVlVG9EaXNjb3VudCIsInZhbHVlV2l0aEl2YSIsIm5ld0ludm9pY2VUb3RhbCIsInJlc3VsdE9yaWdpbmFsIiwicmVzdWx0RGlzY291bnQiLCJyZXN1bHRUb3RhbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJtYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVkFSSUFCTEVTIFkgRUxFTUVOVE9TIERFTCBET01cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFycmF5IHBhcmEgYWxtYWNlbmFyIGxvcyBwcm9kdWN0b3MgYSBkZXNjb250YXJcbi8vIENhZGEgcHJvZHVjdG8gZXMgdW4gb2JqZXRvOiB7IHZhbHVlOiBuw7ptZXJvLCBpc0hhbGY6IGJvb2xlYW5vIH1cbmxldCBwcm9kdWN0c1RvRGlzY291bnQgPSBbXTtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHNhZmVseSBnZXQgRE9NIGVsZW1lbnRzXG5jb25zdCBzYWZlR2V0RWxlbWVudCA9IChpZCkgPT4ge1xuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufTtcblxuY29uc3QgaW52b2ljZVRvdGFsSW5wdXQgPSBzYWZlR2V0RWxlbWVudCgnaW52b2ljZS10b3RhbCcpO1xuY29uc3QgcHJvZHVjdFZhbHVlSW5wdXQgPSBzYWZlR2V0RWxlbWVudCgncHJvZHVjdC12YWx1ZScpO1xuY29uc3QgaXNIYWxmQ2hlY2tib3ggPSBzYWZlR2V0RWxlbWVudCgnaXMtaGFsZicpO1xuY29uc3QgYWRkUHJvZHVjdEJ0biA9IHNhZmVHZXRFbGVtZW50KCdhZGQtcHJvZHVjdC1idG4nKTtcbmNvbnN0IGNhbGN1bGF0ZUJ0biA9IHNhZmVHZXRFbGVtZW50KCdjYWxjdWxhdGUtYnRuJyk7XG5jb25zdCBwcm9kdWN0c0xpc3QgPSBzYWZlR2V0RWxlbWVudCgncHJvZHVjdHMtbGlzdCcpO1xuY29uc3QgcmVzdWx0c0NhcmQgPSBzYWZlR2V0RWxlbWVudCgncmVzdWx0cy1jYXJkJyk7XG5jb25zdCBjbGVhckFsbEJ0biA9IHNhZmVHZXRFbGVtZW50KCdjbGVhci1hbGwtYnRuJyk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFVUSUxJREFEOiBGb3JtYXRlYXIgbW9uZWRhIENMUFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRm9ybWF0ZWEgdW4gbsO6bWVybyBjb21vIG1vbmVkYSBjaGlsZW5hIChwZXNvcykgY29uIDIgZGVjaW1hbGVzXG4vLyBFamVtcGxvOiAxMDAwMC41MCAtPiBcIiQxMC4wMDAsNTBcIlxuY29uc3QgZm9ybWF0Q3VycmVuY3kgPSAoYW1vdW50KSA9PiB7XG4gICAgcmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZXMtQ0wnLCB7IFxuICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JywgXG4gICAgICAgIGN1cnJlbmN5OiAnQ0xQJyxcbiAgICAgICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAyLFxuICAgICAgICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM6IDJcbiAgICB9KS5mb3JtYXQoYW1vdW50KTtcbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1BTkVKTyBERSBFUlJPUkVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBSZWZlcmVuY2lhcyBhIGVsZW1lbnRvcyBET00gcGFyYSBtb3N0cmFyIG1lbnNhamVzIGRlIGVycm9yXG5jb25zdCBlcnJvckFsZXJ0RWxlbWVudCA9IHNhZmVHZXRFbGVtZW50KCdlcnJvci1hbGVydCcpO1xuY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHNhZmVHZXRFbGVtZW50KCdlcnJvci1tZXNzYWdlJyk7XG5cbi8vIE11ZXN0cmEgdW4gbWVuc2FqZSBkZSBlcnJvciBlbiBsYSBpbnRlcmZhelxuLy8gQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgLSBNZW5zYWplIGRlIGVycm9yIGEgbW9zdHJhclxuY29uc3Qgc2hvd0Vycm9yID0gKG1lc3NhZ2UpID0+IHtcbiAgICBpZiAoZXJyb3JNZXNzYWdlRWxlbWVudCkge1xuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgICB9XG4gICAgaWYgKGVycm9yQWxlcnRFbGVtZW50KSB7XG4gICAgICAgIGVycm9yQWxlcnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIH1cbn07XG5cbi8vIE9jdWx0YSBlbCBtZW5zYWplIGRlIGVycm9yXG5jb25zdCBoaWRlRXJyb3IgPSAoKSA9PiB7XG4gICAgaWYgKGVycm9yQWxlcnRFbGVtZW50KSB7XG4gICAgICAgIGVycm9yQWxlcnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfVxufTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUkVOREVSSVpBUiBMSVNUQSBERSBQUk9EVUNUT1Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFjdHVhbGl6YSBsYSBpbnRlcmZheiBtb3N0cmFuZG8gbGEgbGlzdGEgZGUgcHJvZHVjdG9zIGFncmVnYWRvc1xuLy8gU2kgbm8gaGF5IHByb2R1Y3RvcywgbXVlc3RyYSB1biBlc3RhZG8gdmFjw61vXG5mdW5jdGlvbiByZW5kZXJQcm9kdWN0c0xpc3QoKSB7XG4gICAgLy8gUmV0dXJuIGVhcmx5IGlmIG5vdCBpbiBicm93c2VyIGVudmlyb25tZW50XG4gICAgaWYgKCFwcm9kdWN0c0xpc3QgfHwgdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIExpbXBpYXIgbGlzdGEgZGUgbWFuZXJhIHNlZ3VyYVxuICAgIHdoaWxlIChwcm9kdWN0c0xpc3QuZmlyc3RDaGlsZCkge1xuICAgICAgICBwcm9kdWN0c0xpc3QucmVtb3ZlQ2hpbGQocHJvZHVjdHNMaXN0LmZpcnN0Q2hpbGQpO1xuICAgIH1cbiAgICBcbiAgICBpZiAocHJvZHVjdHNUb0Rpc2NvdW50Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zdCBlbXB0eVN0YXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgICAgICBlbXB0eVN0YXRlLmNsYXNzTmFtZSA9ICdlbXB0eS1zdGF0ZSc7XG4gICAgICAgIGVtcHR5U3RhdGUudGV4dENvbnRlbnQgPSAnTm8gaGF5IHByb2R1Y3RvcyBhZ3JlZ2Fkb3MnO1xuICAgICAgICBwcm9kdWN0c0xpc3QuYXBwZW5kQ2hpbGQoZW1wdHlTdGF0ZSk7XG4gICAgICAgIGlmIChjYWxjdWxhdGVCdG4pIGNhbGN1bGF0ZUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBpZiAoY2xlYXJBbGxCdG4pIGNsZWFyQWxsQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgcHJvZHVjdHNUb0Rpc2NvdW50LmZvckVhY2goKHByb2R1Y3QsIGlkeCkgPT4ge1xuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGl2LmNsYXNzTmFtZSA9ICdwcm9kdWN0LWl0ZW0nO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcHJvZHVjdEluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgcHJvZHVjdEluZm8uY2xhc3NOYW1lID0gJ3Byb2R1Y3QtaW5mbyc7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgICAgICBjb25zdCBzdHJvbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHJvbmcnKTtcbiAgICAgICAgLy8gVXNhciB2YWxvciBmbG9hdCBkaXJlY3RhbWVudGVcbiAgICAgICAgY29uc3QgYmFzZVZhbHVlID0gcHJvZHVjdC5pc0hhbGYgPyBwcm9kdWN0LnZhbHVlIC8gMiA6IHByb2R1Y3QudmFsdWU7XG4gICAgICAgIHN0cm9uZy50ZXh0Q29udGVudCA9IGZvcm1hdEN1cnJlbmN5KGJhc2VWYWx1ZSk7XG4gICAgICAgIFxuICAgICAgICBwLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdQcm9kdWN0byBjb24gdmFsb3IgYmFzZSBkZSAnKSk7XG4gICAgICAgIHAuYXBwZW5kQ2hpbGQoc3Ryb25nKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHNtYWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc21hbGwnKTtcbiAgICAgICAgc21hbGwudGV4dENvbnRlbnQgPSBgVW5pZGFkZXM6ICR7cHJvZHVjdC5pc0hhbGYgPyAnU8OtJyA6ICdObyd9YDtcbiAgICAgICAgXG4gICAgICAgIHByb2R1Y3RJbmZvLmFwcGVuZENoaWxkKHApO1xuICAgICAgICBwcm9kdWN0SW5mby5hcHBlbmRDaGlsZChzbWFsbCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgYnV0dG9uLmNsYXNzTmFtZSA9ICdidG4gYnRuLW91dGxpbmUgYnRuLXNtYWxsJztcbiAgICAgICAgYnV0dG9uLmRhdGFzZXQuaWR4ID0gaWR4O1xuICAgICAgICBidXR0b24udGl0bGUgPSAnRWxpbWluYXInO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXIgw61jb25vIGRlIGVsaW1pbmFjacOzbiBkZSBtYW5lcmEgc2VndXJhXG4gICAgICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIGljb24udGV4dENvbnRlbnQgPSAn4pyVJzsgLy8gVXNvIGRlIGVudGlkYWQgc2VndXJhXG4gICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChpY29uKTtcbiAgICAgICAgXG4gICAgICAgIGRpdi5hcHBlbmRDaGlsZChwcm9kdWN0SW5mbyk7XG4gICAgICAgIGRpdi5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgICAgICBwcm9kdWN0c0xpc3QuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICB9KTtcbiAgICBcbiAgICAvLyBNb3N0cmFyIGJvdG9uZXMgY3VhbmRvIGhheSBwcm9kdWN0b3NcbiAgICBpZiAoY2FsY3VsYXRlQnRuKSBjYWxjdWxhdGVCdG4uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgaWYgKGNsZWFyQWxsQnRuKSBjbGVhckFsbEJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICBcbiAgICAvLyBBc2lnbmFyIGV2ZW50b3MgYSBsb3MgYm90b25lcyBkZSBlbGltaW5hclxuICAgIGlmIChwcm9kdWN0c0xpc3QucXVlcnlTZWxlY3RvckFsbCkge1xuICAgICAgICBwcm9kdWN0c0xpc3QucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2RhdGEtaWR4XScpLmZvckVhY2goYnRuID0+IHtcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWR4ID0gcGFyc2VJbnQoYnRuLmdldEF0dHJpYnV0ZSgnZGF0YS1pZHgnKSk7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihpZHgpICYmIGlkeCA+PSAwICYmIGlkeCA8IHByb2R1Y3RzVG9EaXNjb3VudC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHNUb0Rpc2NvdW50LnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgICAgICAgICByZW5kZXJQcm9kdWN0c0xpc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNDYXJkKSByZXN1bHRzQ2FyZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UTzogQWdyZWdhciBwcm9kdWN0b1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTWFuZWphIGVsIGNsaWMgZW4gZWwgYm90w7NuIFwiQWdyZWdhciBwcm9kdWN0b1wiOlxuLy8gMS4gVmFsaWRhIHF1ZSBlbCB2YWxvciBpbmdyZXNhZG8gc2VhIHbDoWxpZG8gKD4wKVxuLy8gMi4gQWdyZWdhIGVsIHByb2R1Y3RvIGFsIGFycmF5IHByb2R1Y3RzVG9EaXNjb3VudFxuLy8gMy4gQWN0dWFsaXphIGxhIGxpc3RhIGRlIHByb2R1Y3Rvc1xuLy8gNC4gTGltcGlhIGxvcyBjYW1wb3MgZGUgZW50cmFkYVxuaWYgKGFkZFByb2R1Y3RCdG4pIHtcbiAgICBhZGRQcm9kdWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHBhcnNlRmxvYXQocHJvZHVjdFZhbHVlSW5wdXQ/LnZhbHVlKTtcbiAgICAgICAgY29uc3QgaXNIYWxmID0gaXNIYWxmQ2hlY2tib3g/LmNoZWNrZWQ7XG5cbiAgICAvLyBWYWxpZGFjacOzbiBtZWpvcmFkYSAtIHZhbG9yZXMgbnVtw6lyaWNvcyB5IGzDrW1pdGVzXG4gICAgaWYgKGlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA8PSAwIHx8IHZhbHVlID4gMTAwMDAwMDAwMCkge1xuICAgICAgICBzaG93RXJyb3IoJ1BvciBmYXZvciwgaW5ncmVzZSB1biB2YWxvciBkZSBwcm9kdWN0byB2w6FsaWRvIGVudHJlIDEgeSAxLjAwMC4wMDAuMDAwLicpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIFZhbGlkYXIgcXVlIGVsIHZhbG9yIG5vIGNvbnRlbmdhIG3DoXMgZGUgMiBkZWNpbWFsZXNcbiAgICBpZiAoKHZhbHVlLnRvU3RyaW5nKCkuc3BsaXQoJy4nKVsxXSB8fCBbXSkubGVuZ3RoID4gMikge1xuICAgICAgICBzaG93RXJyb3IoJ1BvciBmYXZvciwgaW5ncmVzZSB1biB2YWxvciBjb24gbcOheGltbyAyIGRlY2ltYWxlcy4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgICAgICAvLyBHdWFyZGFtb3MgZWwgcHJvZHVjdG8gZW4gbnVlc3RybyBhcnJheVxuICAgICAgICBwcm9kdWN0c1RvRGlzY291bnQucHVzaCh7IHZhbHVlLCBpc0hhbGYgfSk7XG4gICAgICAgIHJlbmRlclByb2R1Y3RzTGlzdCgpO1xuICAgICAgICAvLyBMaW1waWFtb3MgbG9zIGlucHV0cyB5IG9jdWx0YW1vcyBlcnJvcmVzXG4gICAgICAgIGlmIChwcm9kdWN0VmFsdWVJbnB1dCkgcHJvZHVjdFZhbHVlSW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgaWYgKGlzSGFsZkNoZWNrYm94KSBpc0hhbGZDaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gICAgICAgIGlmIChwcm9kdWN0VmFsdWVJbnB1dCkgcHJvZHVjdFZhbHVlSW5wdXQuZm9jdXMoKTtcbiAgICAgICAgaGlkZUVycm9yKCk7XG4gICAgfSk7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVWRU5UTzogTGltcGlhciB0b2RvXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBSZXNldGVhIHRvZGEgbGEgYXBsaWNhY2nDs246XG4vLyAxLiBWYWPDrWEgbGEgbGlzdGEgZGUgcHJvZHVjdG9zXG4vLyAyLiBMaW1waWEgdG9kb3MgbG9zIGNhbXBvcyBkZSBlbnRyYWRhXG4vLyAzLiBPY3VsdGEgbG9zIHJlc3VsdGFkb3NcbmlmIChjbGVhckFsbEJ0bikge1xuICAgIGNsZWFyQWxsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBwcm9kdWN0c1RvRGlzY291bnQubGVuZ3RoID0gMDtcbiAgICAgICAgcmVuZGVyUHJvZHVjdHNMaXN0KCk7XG4gICAgICAgIGlmIChyZXN1bHRzQ2FyZCkgcmVzdWx0c0NhcmQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgaWYgKHByb2R1Y3RWYWx1ZUlucHV0KSBwcm9kdWN0VmFsdWVJbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICBpZiAoaXNIYWxmQ2hlY2tib3gpIGlzSGFsZkNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKGludm9pY2VUb3RhbElucHV0KSBpbnZvaWNlVG90YWxJbnB1dC52YWx1ZSA9ICcnO1xuICAgIH0pO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBFVkVOVE86IENhbGN1bGFyIGRlc2N1ZW50byBmaW5hbFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUmVhbGl6YSBlbCBjw6FsY3VsbyBjb21wbGV0byBkZSBkZXNjdWVudG9zOlxuLy8gMS4gVmFsaWRhIGVsIG1vbnRvIHRvdGFsIGRlIGxhIGZhY3R1cmFcbi8vIDIuIENhbGN1bGEgZWwgZGVzY3VlbnRvIHBhcmEgY2FkYSBwcm9kdWN0byAoY29uc2lkZXJhbmRvIElWQSlcbi8vIDMuIEFjdHVhbGl6YSBsYSBpbnRlcmZheiBjb24gbG9zIHJlc3VsdGFkb3NcbmlmIChjYWxjdWxhdGVCdG4pIHtcbiAgICBjYWxjdWxhdGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG9yaWdpbmFsSW52b2ljZVRvdGFsID0gcGFyc2VGbG9hdChpbnZvaWNlVG90YWxJbnB1dD8udmFsdWUpO1xuXG4gICAgLy8gVmFsaWRhY2nDs24gbWVqb3JhZGEgcGFyYSBlbCB0b3RhbCBkZSBsYSBmYWN0dXJhXG4gICAgaWYgKGlzTmFOKG9yaWdpbmFsSW52b2ljZVRvdGFsKSB8fCBvcmlnaW5hbEludm9pY2VUb3RhbCA8PSAwIHx8IG9yaWdpbmFsSW52b2ljZVRvdGFsID4gMTAwMDAwMDAwMDApIHtcbiAgICAgICAgc2hvd0Vycm9yKCdQb3IgZmF2b3IsIGluZ3Jlc2UgdW4gbW9udG8gZGUgZmFjdHVyYSB2w6FsaWRvIGVudHJlIDEgeSAxMC4wMDAuMDAwLjAwMC4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICAvLyBWYWxpZGFyIGRlY2ltYWxlc1xuICAgIGlmICgob3JpZ2luYWxJbnZvaWNlVG90YWwudG9TdHJpbmcoKS5zcGxpdCgnLicpWzFdIHx8IFtdKS5sZW5ndGggPiAyKSB7XG4gICAgICAgIHNob3dFcnJvcignRWwgbW9udG8gZGUgbGEgZmFjdHVyYSBkZWJlIHRlbmVyIG3DoXhpbW8gMiBkZWNpbWFsZXMuJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAocHJvZHVjdHNUb0Rpc2NvdW50Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzaG93RXJyb3IoJ1BvciBmYXZvciwgYcOxYWRhIGFsIG1lbm9zIHVuIHByb2R1Y3RvIHBhcmEgZGVzY29udGFyLicpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIGhpZGVFcnJvcigpO1xuXG4gICAgbGV0IHRvdGFsRGlzY291bnRBbW91bnQgPSAwO1xuICAgIGNvbnN0IElWQV9SQVRFID0gMC4xOTsgLy8gVGFzYSBkZSBJVkEgKDE5JSlcblxuICAgIC8vIEPDoWxjdWxvIGRlIGRlc2N1ZW50byBtYW50ZW5pZW5kbyBwcmVjaXNpw7NuIGZsb2F0XG4gICAgcHJvZHVjdHNUb0Rpc2NvdW50LmZvckVhY2gocHJvZHVjdCA9PiB7XG4gICAgICAgIC8vIDEuIERldGVybWluYXIgdmFsb3IgYmFzZTogY29tcGxldG8gbyBtaXRhZCAocGFyYSB1bmlkYWRlcylcbiAgICAgICAgbGV0IGJhc2VWYWx1ZVRvRGlzY291bnQgPSBwcm9kdWN0LmlzSGFsZiA/IHByb2R1Y3QudmFsdWUgLyAyIDogcHJvZHVjdC52YWx1ZTtcbiAgICAgICAgXG4gICAgICAgIC8vIDIuIENhbGN1bGFyIHZhbG9yIGNvbiBJVkE6IGJhc2UgKiAoMSArIElWQV9SQVRFKVxuICAgICAgICBsZXQgdmFsdWVXaXRoSXZhID0gYmFzZVZhbHVlVG9EaXNjb3VudCAqICgxICsgSVZBX1JBVEUpO1xuICAgICAgICBcbiAgICAgICAgLy8gMy4gQWN1bXVsYXIgYWwgZGVzY3VlbnRvIHRvdGFsIG1hbnRlbmllbmRvIGZsb2F0XG4gICAgICAgIHRvdGFsRGlzY291bnRBbW91bnQgKz0gdmFsdWVXaXRoSXZhO1xuICAgIH0pO1xuXG4gICAgLy8gNC4gQ2FsY3VsYXIgZWwgbnVldm8gdG90YWwgY29uIGZsb2F0XG4gICAgY29uc3QgbmV3SW52b2ljZVRvdGFsID0gb3JpZ2luYWxJbnZvaWNlVG90YWwgLSB0b3RhbERpc2NvdW50QW1vdW50O1xuXG4gICAgICAgIC8vIE1vc3RyYW1vcyBsb3MgcmVzdWx0YWRvc1xuICAgICAgICBjb25zdCByZXN1bHRPcmlnaW5hbCA9IHNhZmVHZXRFbGVtZW50KCdyZXN1bHQtb3JpZ2luYWwnKTtcbiAgICAgICAgY29uc3QgcmVzdWx0RGlzY291bnQgPSBzYWZlR2V0RWxlbWVudCgncmVzdWx0LWRpc2NvdW50Jyk7XG4gICAgICAgIGNvbnN0IHJlc3VsdFRvdGFsID0gc2FmZUdldEVsZW1lbnQoJ3Jlc3VsdC10b3RhbCcpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHJlc3VsdE9yaWdpbmFsKSByZXN1bHRPcmlnaW5hbC50ZXh0Q29udGVudCA9IGZvcm1hdEN1cnJlbmN5KG9yaWdpbmFsSW52b2ljZVRvdGFsKTtcbiAgICAgICAgaWYgKHJlc3VsdERpc2NvdW50KSByZXN1bHREaXNjb3VudC50ZXh0Q29udGVudCA9IGZvcm1hdEN1cnJlbmN5KHRvdGFsRGlzY291bnRBbW91bnQpO1xuICAgICAgICBpZiAocmVzdWx0VG90YWwpIHJlc3VsdFRvdGFsLnRleHRDb250ZW50ID0gZm9ybWF0Q3VycmVuY3kobmV3SW52b2ljZVRvdGFsKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZXN1bHRzQ2FyZCkgcmVzdWx0c0NhcmQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfSk7XG59XG5cbi8vIEV4cG9ydCBmdW5jdGlvbnMgZm9yIHRlc3RpbmdcbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0ge1xuICAgICAgICBmb3JtYXRDdXJyZW5jeSxcbiAgICAgICAgc2hvd0Vycm9yLFxuICAgICAgICBoaWRlRXJyb3IsXG4gICAgICAgIHJlbmRlclByb2R1Y3RzTGlzdCxcbiAgICAgICAgcHJvZHVjdHNUb0Rpc2NvdW50LFxuICAgICAgICBzYWZlR2V0RWxlbWVudFxuICAgIH07XG59XG4iXSwibWFwcGluZ3MiOiI7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUlBLGtCQUFrQixHQUFHLEVBQUU7O0FBRTNCO0FBQ0EsTUFBTUMsY0FBYyxHQUFJQyxFQUFFLElBQUs7RUFDM0IsSUFBSSxPQUFPQyxRQUFRLEtBQUssV0FBVyxJQUFJQSxRQUFRLENBQUNDLGNBQWMsRUFBRTtJQUM1RCxPQUFPRCxRQUFRLENBQUNDLGNBQWMsQ0FBQ0YsRUFBRSxDQUFDO0VBQ3RDO0VBQ0EsT0FBTyxJQUFJO0FBQ2YsQ0FBQztBQUVELE1BQU1HLGlCQUFpQixHQUFHSixjQUFjLENBQUMsZUFBZSxDQUFDO0FBQ3pELE1BQU1LLGlCQUFpQixHQUFHTCxjQUFjLENBQUMsZUFBZSxDQUFDO0FBQ3pELE1BQU1NLGNBQWMsR0FBR04sY0FBYyxDQUFDLFNBQVMsQ0FBQztBQUNoRCxNQUFNTyxhQUFhLEdBQUdQLGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQztBQUN2RCxNQUFNUSxZQUFZLEdBQUdSLGNBQWMsQ0FBQyxlQUFlLENBQUM7QUFDcEQsTUFBTVMsWUFBWSxHQUFHVCxjQUFjLENBQUMsZUFBZSxDQUFDO0FBQ3BELE1BQU1VLFdBQVcsR0FBR1YsY0FBYyxDQUFDLGNBQWMsQ0FBQztBQUNsRCxNQUFNVyxXQUFXLEdBQUdYLGNBQWMs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